package com.datatrees.rawdatacentral.plugin.operator.jiang_su_10086_wap;

import javax.script.Invocable;
import java.io.InputStream;
import java.util.Base64;
import java.util.Date;
import java.util.Map;

import com.alibaba.fastjson.JSONObject;
import com.datatrees.rawdatacentral.common.http.TaskHttpClient;
import com.datatrees.rawdatacentral.common.http.TaskUtils;
import com.datatrees.rawdatacentral.common.utils.CheckUtils;
import com.datatrees.rawdatacentral.common.utils.DateUtils;
import com.datatrees.rawdatacentral.common.utils.RegexpUtils;
import com.datatrees.rawdatacentral.common.utils.ScriptEngineUtil;
import com.datatrees.rawdatacentral.domain.constant.FormType;
import com.datatrees.rawdatacentral.domain.enums.ErrorCode;
import com.datatrees.rawdatacentral.domain.enums.RequestType;
import com.datatrees.rawdatacentral.domain.operator.OperatorParam;
import com.datatrees.rawdatacentral.domain.result.HttpResult;
import com.datatrees.rawdatacentral.domain.vo.Response;
import com.datatrees.rawdatacentral.service.OperatorPluginService;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

/**
 * 江苏移动--wap
 * 登陆地址:http://wap.js.10086.cn/login.thtml
 * 登陆(服务密码登陆):手机号,服务密码,图片验证码(不支持验证)
 * 详单:短信验证码
 * Created by zhouxinghai on 2017/8/28
 */
public class JiangSu10086ForWap implements OperatorPluginService {

    private static final Logger logger = LoggerFactory.getLogger(JiangSu10086ForWap.class);

    private static final String javaScript = "ZnVuY3Rpb24gZW5jcnlwdEJ5REVTKG1lc3NhZ2UpIHsKICAgIHZhciBrZXlIZXggPSBDcnlwdG9KUy5lbmMuVXRmOC5wYXJzZSgiMTIzNDU2Nzg5MCIpOwogICAgdmFyIGVuY3J5cHRlZCA9IENyeXB0b0pTLkRFUy5lbmNyeXB0KG1lc3NhZ2UsIGtleUhleCwgewogICAgICAgIG1vZGU6IENyeXB0b0pTLm1vZGUuRUNCLAogICAgICAgIHBhZGRpbmc6IENyeXB0b0pTLnBhZC5Qa2NzNwogICAgfSk7CiAgICByZXR1cm4gZW5jcnlwdGVkLnRvU3RyaW5nKCk7Cn0KCi8qCiBDcnlwdG9KUyB2My4xLjIKIGNvZGUuZ29vZ2xlLmNvbS9wL2NyeXB0by1qcwogKGMpIDIwMDktMjAxMyBieSBKZWZmIE1vdHQuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiBjb2RlLmdvb2dsZS5jb20vcC9jcnlwdG8tanMvd2lraS9MaWNlbnNlCiAqLwp2YXIgQ3J5cHRvSlM9Q3J5cHRvSlN8fGZ1bmN0aW9uKHUsbCl7dmFyIGQ9e30sbj1kLmxpYj17fSxwPWZ1bmN0aW9uKCl7fSxzPW4uQmFzZT17ZXh0ZW5kOmZ1bmN0aW9uKGEpe3AucHJvdG90eXBlPXRoaXM7dmFyIGM9bmV3IHA7YSYmYy5taXhJbihhKTtjLmhhc093blByb3BlcnR5KCJpbml0Iil8fChjLmluaXQ9ZnVuY3Rpb24oKXtjLiRzdXBlci5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pO2MuaW5pdC5wcm90b3R5cGU9YztjLiRzdXBlcj10aGlzO3JldHVybiBjfSxjcmVhdGU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmV4dGVuZCgpO2EuaW5pdC5hcHBseShhLGFyZ3VtZW50cyk7cmV0dXJuIGF9LGluaXQ6ZnVuY3Rpb24oKXt9LG1peEluOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYyBpbiBhKWEuaGFzT3duUHJvcGVydHkoYykmJih0aGlzW2NdPWFbY10pO2EuaGFzT3duUHJvcGVydHkoInRvU3RyaW5nIikmJih0aGlzLnRvU3RyaW5nPWEudG9TdHJpbmcpfSxjbG9uZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmluaXQucHJvdG90eXBlLmV4dGVuZCh0aGlzKX19LAogICAgICAgIHE9bi5Xb3JkQXJyYXk9cy5leHRlbmQoe2luaXQ6ZnVuY3Rpb24oYSxjKXthPXRoaXMud29yZHM9YXx8W107dGhpcy5zaWdCeXRlcz1jIT1sP2M6NCphLmxlbmd0aH0sdG9TdHJpbmc6ZnVuY3Rpb24oYSl7cmV0dXJuKGF8fHYpLnN0cmluZ2lmeSh0aGlzKX0sY29uY2F0OmZ1bmN0aW9uKGEpe3ZhciBjPXRoaXMud29yZHMsbT1hLndvcmRzLGY9dGhpcy5zaWdCeXRlczthPWEuc2lnQnl0ZXM7dGhpcy5jbGFtcCgpO2lmKGYlNClmb3IodmFyIHQ9MDt0PGE7dCsrKWNbZit0Pj4+Ml18PShtW3Q+Pj4yXT4+PjI0LTgqKHQlNCkmMjU1KTw8MjQtOCooKGYrdCklNCk7ZWxzZSBpZig2NTUzNTxtLmxlbmd0aClmb3IodD0wO3Q8YTt0Kz00KWNbZit0Pj4+Ml09bVt0Pj4+Ml07ZWxzZSBjLnB1c2guYXBwbHkoYyxtKTt0aGlzLnNpZ0J5dGVzKz1hO3JldHVybiB0aGlzfSxjbGFtcDpmdW5jdGlvbigpe3ZhciBhPXRoaXMud29yZHMsYz10aGlzLnNpZ0J5dGVzO2FbYz4+PjJdJj00Mjk0OTY3Mjk1PDwKICAgICAgICAgICAgMzItOCooYyU0KTthLmxlbmd0aD11LmNlaWwoYy80KX0sY2xvbmU6ZnVuY3Rpb24oKXt2YXIgYT1zLmNsb25lLmNhbGwodGhpcyk7YS53b3Jkcz10aGlzLndvcmRzLnNsaWNlKDApO3JldHVybiBhfSxyYW5kb206ZnVuY3Rpb24oYSl7Zm9yKHZhciBjPVtdLG09MDttPGE7bSs9NCljLnB1c2goNDI5NDk2NzI5Nip1LnJhbmRvbSgpfDApO3JldHVybiBuZXcgcS5pbml0KGMsYSl9fSksdz1kLmVuYz17fSx2PXcuSGV4PXtzdHJpbmdpZnk6ZnVuY3Rpb24oYSl7dmFyIGM9YS53b3JkczthPWEuc2lnQnl0ZXM7Zm9yKHZhciBtPVtdLGY9MDtmPGE7ZisrKXt2YXIgdD1jW2Y+Pj4yXT4+PjI0LTgqKGYlNCkmMjU1O20ucHVzaCgodD4+PjQpLnRvU3RyaW5nKDE2KSk7bS5wdXNoKCh0JjE1KS50b1N0cmluZygxNikpfXJldHVybiBtLmpvaW4oIiIpfSxwYXJzZTpmdW5jdGlvbihhKXtmb3IodmFyIGM9YS5sZW5ndGgsbT1bXSxmPTA7ZjxjO2YrPTIpbVtmPj4+M118PXBhcnNlSW50KGEuc3Vic3RyKGYsCiAgICAgICAgICAgICAgICAyKSwxNik8PDI0LTQqKGYlOCk7cmV0dXJuIG5ldyBxLmluaXQobSxjLzIpfX0sYj13LkxhdGluMT17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3ZhciBjPWEud29yZHM7YT1hLnNpZ0J5dGVzO2Zvcih2YXIgbT1bXSxmPTA7ZjxhO2YrKyltLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShjW2Y+Pj4yXT4+PjI0LTgqKGYlNCkmMjU1KSk7cmV0dXJuIG0uam9pbigiIil9LHBhcnNlOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYz1hLmxlbmd0aCxtPVtdLGY9MDtmPGM7ZisrKW1bZj4+PjJdfD0oYS5jaGFyQ29kZUF0KGYpJjI1NSk8PDI0LTgqKGYlNCk7cmV0dXJuIG5ldyBxLmluaXQobSxjKX19LHg9dy5VdGY4PXtzdHJpbmdpZnk6ZnVuY3Rpb24oYSl7dHJ5e3JldHVybiBkZWNvZGVVUklDb21wb25lbnQoZXNjYXBlKGIuc3RyaW5naWZ5KGEpKSl9Y2F0Y2goYyl7dGhyb3cgRXJyb3IoIk1hbGZvcm1lZCBVVEYtOCBkYXRhIik7fX0scGFyc2U6ZnVuY3Rpb24oYSl7cmV0dXJuIGIucGFyc2UodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGEpKSl9fSwKICAgICAgICByPW4uQnVmZmVyZWRCbG9ja0FsZ29yaXRobT1zLmV4dGVuZCh7cmVzZXQ6ZnVuY3Rpb24oKXt0aGlzLl9kYXRhPW5ldyBxLmluaXQ7dGhpcy5fbkRhdGFCeXRlcz0wfSxfYXBwZW5kOmZ1bmN0aW9uKGEpeyJzdHJpbmciPT10eXBlb2YgYSYmKGE9eC5wYXJzZShhKSk7dGhpcy5fZGF0YS5jb25jYXQoYSk7dGhpcy5fbkRhdGFCeXRlcys9YS5zaWdCeXRlc30sX3Byb2Nlc3M6ZnVuY3Rpb24oYSl7dmFyIGM9dGhpcy5fZGF0YSxtPWMud29yZHMsZj1jLnNpZ0J5dGVzLHQ9dGhpcy5ibG9ja1NpemUsYj1mLyg0KnQpLGI9YT91LmNlaWwoYik6dS5tYXgoKGJ8MCktdGhpcy5fbWluQnVmZmVyU2l6ZSwwKTthPWIqdDtmPXUubWluKDQqYSxmKTtpZihhKXtmb3IodmFyIGU9MDtlPGE7ZSs9dCl0aGlzLl9kb1Byb2Nlc3NCbG9jayhtLGUpO2U9bS5zcGxpY2UoMCxhKTtjLnNpZ0J5dGVzLT1mfXJldHVybiBuZXcgcS5pbml0KGUsZil9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGE9cy5jbG9uZS5jYWxsKHRoaXMpOwogICAgICAgICAgICBhLl9kYXRhPXRoaXMuX2RhdGEuY2xvbmUoKTtyZXR1cm4gYX0sX21pbkJ1ZmZlclNpemU6MH0pO24uSGFzaGVyPXIuZXh0ZW5kKHtjZmc6cy5leHRlbmQoKSxpbml0OmZ1bmN0aW9uKGEpe3RoaXMuY2ZnPXRoaXMuY2ZnLmV4dGVuZChhKTt0aGlzLnJlc2V0KCl9LHJlc2V0OmZ1bmN0aW9uKCl7ci5yZXNldC5jYWxsKHRoaXMpO3RoaXMuX2RvUmVzZXQoKX0sdXBkYXRlOmZ1bmN0aW9uKGEpe3RoaXMuX2FwcGVuZChhKTt0aGlzLl9wcm9jZXNzKCk7cmV0dXJuIHRoaXN9LGZpbmFsaXplOmZ1bmN0aW9uKGEpe2EmJnRoaXMuX2FwcGVuZChhKTtyZXR1cm4gdGhpcy5fZG9GaW5hbGl6ZSgpfSxibG9ja1NpemU6MTYsX2NyZWF0ZUhlbHBlcjpmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oYyxtKXtyZXR1cm4obmV3IGEuaW5pdChtKSkuZmluYWxpemUoYyl9fSxfY3JlYXRlSG1hY0hlbHBlcjpmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oYyxtKXtyZXR1cm4obmV3IGUuSE1BQy5pbml0KGEsCiAgICAgICAgbSkpLmZpbmFsaXplKGMpfX19KTt2YXIgZT1kLmFsZ289e307cmV0dXJuIGR9KE1hdGgpOwooZnVuY3Rpb24oKXt2YXIgdT1DcnlwdG9KUyxsPXUubGliLldvcmRBcnJheTt1LmVuYy5CYXNlNjQ9e3N0cmluZ2lmeTpmdW5jdGlvbihkKXt2YXIgbj1kLndvcmRzLGw9ZC5zaWdCeXRlcyxzPXRoaXMuX21hcDtkLmNsYW1wKCk7ZD1bXTtmb3IodmFyIHE9MDtxPGw7cSs9Mylmb3IodmFyIHc9KG5bcT4+PjJdPj4+MjQtOCoocSU0KSYyNTUpPDwxNnwobltxKzE+Pj4yXT4+PjI0LTgqKChxKzEpJTQpJjI1NSk8PDh8bltxKzI+Pj4yXT4+PjI0LTgqKChxKzIpJTQpJjI1NSx2PTA7ND52JiZxKzAuNzUqdjxsO3YrKylkLnB1c2gocy5jaGFyQXQodz4+PjYqKDMtdikmNjMpKTtpZihuPXMuY2hhckF0KDY0KSlmb3IoO2QubGVuZ3RoJTQ7KWQucHVzaChuKTtyZXR1cm4gZC5qb2luKCIiKX0scGFyc2U6ZnVuY3Rpb24oZCl7dmFyIG49ZC5sZW5ndGgscD10aGlzLl9tYXAscz1wLmNoYXJBdCg2NCk7cyYmKHM9ZC5pbmRleE9mKHMpLC0xIT1zJiYobj1zKSk7Zm9yKHZhciBzPVtdLHE9MCx3PTA7dzwKbjt3KyspaWYodyU0KXt2YXIgdj1wLmluZGV4T2YoZC5jaGFyQXQody0xKSk8PDIqKHclNCksYj1wLmluZGV4T2YoZC5jaGFyQXQodykpPj4+Ni0yKih3JTQpO3NbcT4+PjJdfD0odnxiKTw8MjQtOCoocSU0KTtxKyt9cmV0dXJuIGwuY3JlYXRlKHMscSl9LF9tYXA6IkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89In19KSgpOwooZnVuY3Rpb24odSl7ZnVuY3Rpb24gbChiLGUsYSxjLG0sZix0KXtiPWIrKGUmYXx+ZSZjKSttK3Q7cmV0dXJuKGI8PGZ8Yj4+PjMyLWYpK2V9ZnVuY3Rpb24gZChiLGUsYSxjLG0sZix0KXtiPWIrKGUmY3xhJn5jKSttK3Q7cmV0dXJuKGI8PGZ8Yj4+PjMyLWYpK2V9ZnVuY3Rpb24gbihiLGUsYSxjLG0sZix0KXtiPWIrKGVeYV5jKSttK3Q7cmV0dXJuKGI8PGZ8Yj4+PjMyLWYpK2V9ZnVuY3Rpb24gcChiLGUsYSxjLG0sZix0KXtiPWIrKGFeKGV8fmMpKSttK3Q7cmV0dXJuKGI8PGZ8Yj4+PjMyLWYpK2V9Zm9yKHZhciBzPUNyeXB0b0pTLHE9cy5saWIsdz1xLldvcmRBcnJheSx2PXEuSGFzaGVyLHE9cy5hbGdvLGI9W10seD0wOzY0Png7eCsrKWJbeF09NDI5NDk2NzI5Nip1LmFicyh1LnNpbih4KzEpKXwwO3E9cS5NRDU9di5leHRlbmQoe19kb1Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5faGFzaD1uZXcgdy5pbml0KFsxNzMyNTg0MTkzLDQwMjMyMzM0MTcsMjU2MjM4MzEwMiwyNzE3MzM4NzhdKX0sCiAgICBfZG9Qcm9jZXNzQmxvY2s6ZnVuY3Rpb24ocixlKXtmb3IodmFyIGE9MDsxNj5hO2ErKyl7dmFyIGM9ZSthLG09cltjXTtyW2NdPShtPDw4fG0+Pj4yNCkmMTY3MTE5MzV8KG08PDI0fG0+Pj44KSY0Mjc4MjU1MzYwfXZhciBhPXRoaXMuX2hhc2gud29yZHMsYz1yW2UrMF0sbT1yW2UrMV0sZj1yW2UrMl0sdD1yW2UrM10seT1yW2UrNF0scT1yW2UrNV0scz1yW2UrNl0sdz1yW2UrN10sdj1yW2UrOF0sdT1yW2UrOV0seD1yW2UrMTBdLHo9cltlKzExXSxBPXJbZSsxMl0sQj1yW2UrMTNdLEM9cltlKzE0XSxEPXJbZSsxNV0sZz1hWzBdLGg9YVsxXSxqPWFbMl0saz1hWzNdLGc9bChnLGgsaixrLGMsNyxiWzBdKSxrPWwoayxnLGgsaixtLDEyLGJbMV0pLGo9bChqLGssZyxoLGYsMTcsYlsyXSksaD1sKGgsaixrLGcsdCwyMixiWzNdKSxnPWwoZyxoLGosayx5LDcsYls0XSksaz1sKGssZyxoLGoscSwxMixiWzVdKSxqPWwoaixrLGcsaCxzLDE3LGJbNl0pLGg9bChoLGosayxnLHcsMjIsYls3XSksCiAgICAgICAgZz1sKGcsaCxqLGssdiw3LGJbOF0pLGs9bChrLGcsaCxqLHUsMTIsYls5XSksaj1sKGosayxnLGgseCwxNyxiWzEwXSksaD1sKGgsaixrLGcseiwyMixiWzExXSksZz1sKGcsaCxqLGssQSw3LGJbMTJdKSxrPWwoayxnLGgsaixCLDEyLGJbMTNdKSxqPWwoaixrLGcsaCxDLDE3LGJbMTRdKSxoPWwoaCxqLGssZyxELDIyLGJbMTVdKSxnPWQoZyxoLGosayxtLDUsYlsxNl0pLGs9ZChrLGcsaCxqLHMsOSxiWzE3XSksaj1kKGosayxnLGgseiwxNCxiWzE4XSksaD1kKGgsaixrLGcsYywyMCxiWzE5XSksZz1kKGcsaCxqLGsscSw1LGJbMjBdKSxrPWQoayxnLGgsaix4LDksYlsyMV0pLGo9ZChqLGssZyxoLEQsMTQsYlsyMl0pLGg9ZChoLGosayxnLHksMjAsYlsyM10pLGc9ZChnLGgsaixrLHUsNSxiWzI0XSksaz1kKGssZyxoLGosQyw5LGJbMjVdKSxqPWQoaixrLGcsaCx0LDE0LGJbMjZdKSxoPWQoaCxqLGssZyx2LDIwLGJbMjddKSxnPWQoZyxoLGosayxCLDUsYlsyOF0pLGs9ZChrLGcsCiAgICAgICAgICAgIGgsaixmLDksYlsyOV0pLGo9ZChqLGssZyxoLHcsMTQsYlszMF0pLGg9ZChoLGosayxnLEEsMjAsYlszMV0pLGc9bihnLGgsaixrLHEsNCxiWzMyXSksaz1uKGssZyxoLGosdiwxMSxiWzMzXSksaj1uKGosayxnLGgseiwxNixiWzM0XSksaD1uKGgsaixrLGcsQywyMyxiWzM1XSksZz1uKGcsaCxqLGssbSw0LGJbMzZdKSxrPW4oayxnLGgsaix5LDExLGJbMzddKSxqPW4oaixrLGcsaCx3LDE2LGJbMzhdKSxoPW4oaCxqLGssZyx4LDIzLGJbMzldKSxnPW4oZyxoLGosayxCLDQsYls0MF0pLGs9bihrLGcsaCxqLGMsMTEsYls0MV0pLGo9bihqLGssZyxoLHQsMTYsYls0Ml0pLGg9bihoLGosayxnLHMsMjMsYls0M10pLGc9bihnLGgsaixrLHUsNCxiWzQ0XSksaz1uKGssZyxoLGosQSwxMSxiWzQ1XSksaj1uKGosayxnLGgsRCwxNixiWzQ2XSksaD1uKGgsaixrLGcsZiwyMyxiWzQ3XSksZz1wKGcsaCxqLGssYyw2LGJbNDhdKSxrPXAoayxnLGgsaix3LDEwLGJbNDldKSxqPXAoaixrLGcsaCwKICAgICAgICAgICAgQywxNSxiWzUwXSksaD1wKGgsaixrLGcscSwyMSxiWzUxXSksZz1wKGcsaCxqLGssQSw2LGJbNTJdKSxrPXAoayxnLGgsaix0LDEwLGJbNTNdKSxqPXAoaixrLGcsaCx4LDE1LGJbNTRdKSxoPXAoaCxqLGssZyxtLDIxLGJbNTVdKSxnPXAoZyxoLGosayx2LDYsYls1Nl0pLGs9cChrLGcsaCxqLEQsMTAsYls1N10pLGo9cChqLGssZyxoLHMsMTUsYls1OF0pLGg9cChoLGosayxnLEIsMjEsYls1OV0pLGc9cChnLGgsaixrLHksNixiWzYwXSksaz1wKGssZyxoLGoseiwxMCxiWzYxXSksaj1wKGosayxnLGgsZiwxNSxiWzYyXSksaD1wKGgsaixrLGcsdSwyMSxiWzYzXSk7YVswXT1hWzBdK2d8MDthWzFdPWFbMV0raHwwO2FbMl09YVsyXStqfDA7YVszXT1hWzNdK2t8MH0sX2RvRmluYWxpemU6ZnVuY3Rpb24oKXt2YXIgYj10aGlzLl9kYXRhLGU9Yi53b3JkcyxhPTgqdGhpcy5fbkRhdGFCeXRlcyxjPTgqYi5zaWdCeXRlcztlW2M+Pj41XXw9MTI4PDwyNC1jJTMyO3ZhciBtPXUuZmxvb3IoYS8KICAgICAgICA0Mjk0OTY3Mjk2KTtlWyhjKzY0Pj4+OTw8NCkrMTVdPShtPDw4fG0+Pj4yNCkmMTY3MTE5MzV8KG08PDI0fG0+Pj44KSY0Mjc4MjU1MzYwO2VbKGMrNjQ+Pj45PDw0KSsxNF09KGE8PDh8YT4+PjI0KSYxNjcxMTkzNXwoYTw8MjR8YT4+PjgpJjQyNzgyNTUzNjA7Yi5zaWdCeXRlcz00KihlLmxlbmd0aCsxKTt0aGlzLl9wcm9jZXNzKCk7Yj10aGlzLl9oYXNoO2U9Yi53b3Jkcztmb3IoYT0wOzQ+YTthKyspYz1lW2FdLGVbYV09KGM8PDh8Yz4+PjI0KSYxNjcxMTkzNXwoYzw8MjR8Yz4+PjgpJjQyNzgyNTUzNjA7cmV0dXJuIGJ9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGI9di5jbG9uZS5jYWxsKHRoaXMpO2IuX2hhc2g9dGhpcy5faGFzaC5jbG9uZSgpO3JldHVybiBifX0pO3MuTUQ1PXYuX2NyZWF0ZUhlbHBlcihxKTtzLkhtYWNNRDU9di5fY3JlYXRlSG1hY0hlbHBlcihxKX0pKE1hdGgpOwooZnVuY3Rpb24oKXt2YXIgdT1DcnlwdG9KUyxsPXUubGliLGQ9bC5CYXNlLG49bC5Xb3JkQXJyYXksbD11LmFsZ28scD1sLkV2cEtERj1kLmV4dGVuZCh7Y2ZnOmQuZXh0ZW5kKHtrZXlTaXplOjQsaGFzaGVyOmwuTUQ1LGl0ZXJhdGlvbnM6MX0pLGluaXQ6ZnVuY3Rpb24oZCl7dGhpcy5jZmc9dGhpcy5jZmcuZXh0ZW5kKGQpfSxjb21wdXRlOmZ1bmN0aW9uKGQsbCl7Zm9yKHZhciBwPXRoaXMuY2ZnLHY9cC5oYXNoZXIuY3JlYXRlKCksYj1uLmNyZWF0ZSgpLHU9Yi53b3JkcyxyPXAua2V5U2l6ZSxwPXAuaXRlcmF0aW9uczt1Lmxlbmd0aDxyOyl7ZSYmdi51cGRhdGUoZSk7dmFyIGU9di51cGRhdGUoZCkuZmluYWxpemUobCk7di5yZXNldCgpO2Zvcih2YXIgYT0xO2E8cDthKyspZT12LmZpbmFsaXplKGUpLHYucmVzZXQoKTtiLmNvbmNhdChlKX1iLnNpZ0J5dGVzPTQqcjtyZXR1cm4gYn19KTt1LkV2cEtERj1mdW5jdGlvbihkLGwsbil7cmV0dXJuIHAuY3JlYXRlKG4pLmNvbXB1dGUoZCwKICAgIGwpfX0pKCk7CkNyeXB0b0pTLmxpYi5DaXBoZXJ8fGZ1bmN0aW9uKHUpe3ZhciBsPUNyeXB0b0pTLGQ9bC5saWIsbj1kLkJhc2UscD1kLldvcmRBcnJheSxzPWQuQnVmZmVyZWRCbG9ja0FsZ29yaXRobSxxPWwuZW5jLkJhc2U2NCx3PWwuYWxnby5FdnBLREYsdj1kLkNpcGhlcj1zLmV4dGVuZCh7Y2ZnOm4uZXh0ZW5kKCksY3JlYXRlRW5jcnlwdG9yOmZ1bmN0aW9uKG0sYSl7cmV0dXJuIHRoaXMuY3JlYXRlKHRoaXMuX0VOQ19YRk9STV9NT0RFLG0sYSl9LGNyZWF0ZURlY3J5cHRvcjpmdW5jdGlvbihtLGEpe3JldHVybiB0aGlzLmNyZWF0ZSh0aGlzLl9ERUNfWEZPUk1fTU9ERSxtLGEpfSxpbml0OmZ1bmN0aW9uKG0sYSxiKXt0aGlzLmNmZz10aGlzLmNmZy5leHRlbmQoYik7dGhpcy5feGZvcm1Nb2RlPW07dGhpcy5fa2V5PWE7dGhpcy5yZXNldCgpfSxyZXNldDpmdW5jdGlvbigpe3MucmVzZXQuY2FsbCh0aGlzKTt0aGlzLl9kb1Jlc2V0KCl9LHByb2Nlc3M6ZnVuY3Rpb24oYSl7dGhpcy5fYXBwZW5kKGEpO3JldHVybiB0aGlzLl9wcm9jZXNzKCl9LAogICAgZmluYWxpemU6ZnVuY3Rpb24oYSl7YSYmdGhpcy5fYXBwZW5kKGEpO3JldHVybiB0aGlzLl9kb0ZpbmFsaXplKCl9LGtleVNpemU6NCxpdlNpemU6NCxfRU5DX1hGT1JNX01PREU6MSxfREVDX1hGT1JNX01PREU6MixfY3JlYXRlSGVscGVyOmZ1bmN0aW9uKG0pe3JldHVybntlbmNyeXB0OmZ1bmN0aW9uKGYsYixlKXtyZXR1cm4oInN0cmluZyI9PXR5cGVvZiBiP2M6YSkuZW5jcnlwdChtLGYsYixlKX0sZGVjcnlwdDpmdW5jdGlvbihmLGIsZSl7cmV0dXJuKCJzdHJpbmciPT10eXBlb2YgYj9jOmEpLmRlY3J5cHQobSxmLGIsZSl9fX19KTtkLlN0cmVhbUNpcGhlcj12LmV4dGVuZCh7X2RvRmluYWxpemU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcHJvY2VzcyghMCl9LGJsb2NrU2l6ZToxfSk7dmFyIGI9bC5tb2RlPXt9LHg9ZnVuY3Rpb24oYSxmLGIpe3ZhciBjPXRoaXMuX2l2O2M/dGhpcy5faXY9dTpjPXRoaXMuX3ByZXZCbG9jaztmb3IodmFyIGU9MDtlPGI7ZSsrKWFbZitlXV49CiAgICBjW2VdfSxyPShkLkJsb2NrQ2lwaGVyTW9kZT1uLmV4dGVuZCh7Y3JlYXRlRW5jcnlwdG9yOmZ1bmN0aW9uKGEsZil7cmV0dXJuIHRoaXMuRW5jcnlwdG9yLmNyZWF0ZShhLGYpfSxjcmVhdGVEZWNyeXB0b3I6ZnVuY3Rpb24oYSxmKXtyZXR1cm4gdGhpcy5EZWNyeXB0b3IuY3JlYXRlKGEsZil9LGluaXQ6ZnVuY3Rpb24oYSxmKXt0aGlzLl9jaXBoZXI9YTt0aGlzLl9pdj1mfX0pKS5leHRlbmQoKTtyLkVuY3J5cHRvcj1yLmV4dGVuZCh7cHJvY2Vzc0Jsb2NrOmZ1bmN0aW9uKGEsZil7dmFyIGI9dGhpcy5fY2lwaGVyLGM9Yi5ibG9ja1NpemU7eC5jYWxsKHRoaXMsYSxmLGMpO2IuZW5jcnlwdEJsb2NrKGEsZik7dGhpcy5fcHJldkJsb2NrPWEuc2xpY2UoZixmK2MpfX0pO3IuRGVjcnlwdG9yPXIuZXh0ZW5kKHtwcm9jZXNzQmxvY2s6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLl9jaXBoZXIsZT1jLmJsb2NrU2l6ZSxkPWEuc2xpY2UoYixiK2UpO2MuZGVjcnlwdEJsb2NrKGEsYik7eC5jYWxsKHRoaXMsCiAgICBhLGIsZSk7dGhpcy5fcHJldkJsb2NrPWR9fSk7Yj1iLkNCQz1yO3I9KGwucGFkPXt9KS5Qa2NzNz17cGFkOmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPTQqYixjPWMtYS5zaWdCeXRlcyVjLGU9Yzw8MjR8Yzw8MTZ8Yzw8OHxjLGQ9W10sbD0wO2w8YztsKz00KWQucHVzaChlKTtjPXAuY3JlYXRlKGQsYyk7YS5jb25jYXQoYyl9LHVucGFkOmZ1bmN0aW9uKGEpe2Euc2lnQnl0ZXMtPWEud29yZHNbYS5zaWdCeXRlcy0xPj4+Ml0mMjU1fX07ZC5CbG9ja0NpcGhlcj12LmV4dGVuZCh7Y2ZnOnYuY2ZnLmV4dGVuZCh7bW9kZTpiLHBhZGRpbmc6cn0pLHJlc2V0OmZ1bmN0aW9uKCl7di5yZXNldC5jYWxsKHRoaXMpO3ZhciBhPXRoaXMuY2ZnLGM9YS5pdixhPWEubW9kZTtpZih0aGlzLl94Zm9ybU1vZGU9PXRoaXMuX0VOQ19YRk9STV9NT0RFKXZhciBiPWEuY3JlYXRlRW5jcnlwdG9yO2Vsc2UgYj1hLmNyZWF0ZURlY3J5cHRvcix0aGlzLl9taW5CdWZmZXJTaXplPTE7dGhpcy5fbW9kZT1iLmNhbGwoYSwKICAgIHRoaXMsYyYmYy53b3Jkcyl9LF9kb1Byb2Nlc3NCbG9jazpmdW5jdGlvbihhLGMpe3RoaXMuX21vZGUucHJvY2Vzc0Jsb2NrKGEsYyl9LF9kb0ZpbmFsaXplOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jZmcucGFkZGluZztpZih0aGlzLl94Zm9ybU1vZGU9PXRoaXMuX0VOQ19YRk9STV9NT0RFKXthLnBhZCh0aGlzLl9kYXRhLHRoaXMuYmxvY2tTaXplKTt2YXIgYz10aGlzLl9wcm9jZXNzKCEwKX1lbHNlIGM9dGhpcy5fcHJvY2VzcyghMCksYS51bnBhZChjKTtyZXR1cm4gY30sYmxvY2tTaXplOjR9KTt2YXIgZT1kLkNpcGhlclBhcmFtcz1uLmV4dGVuZCh7aW5pdDpmdW5jdGlvbihhKXt0aGlzLm1peEluKGEpfSx0b1N0cmluZzpmdW5jdGlvbihhKXtyZXR1cm4oYXx8dGhpcy5mb3JtYXR0ZXIpLnN0cmluZ2lmeSh0aGlzKX19KSxiPShsLmZvcm1hdD17fSkuT3BlblNTTD17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3ZhciBjPWEuY2lwaGVydGV4dDthPWEuc2FsdDtyZXR1cm4oYT9wLmNyZWF0ZShbMTM5ODg5MzY4NCwKICAgIDE3MDEwNzY4MzFdKS5jb25jYXQoYSkuY29uY2F0KGMpOmMpLnRvU3RyaW5nKHEpfSxwYXJzZTpmdW5jdGlvbihhKXthPXEucGFyc2UoYSk7dmFyIGM9YS53b3JkcztpZigxMzk4ODkzNjg0PT1jWzBdJiYxNzAxMDc2ODMxPT1jWzFdKXt2YXIgYj1wLmNyZWF0ZShjLnNsaWNlKDIsNCkpO2Muc3BsaWNlKDAsNCk7YS5zaWdCeXRlcy09MTZ9cmV0dXJuIGUuY3JlYXRlKHtjaXBoZXJ0ZXh0OmEsc2FsdDpifSl9fSxhPWQuU2VyaWFsaXphYmxlQ2lwaGVyPW4uZXh0ZW5kKHtjZmc6bi5leHRlbmQoe2Zvcm1hdDpifSksZW5jcnlwdDpmdW5jdGlvbihhLGMsYixkKXtkPXRoaXMuY2ZnLmV4dGVuZChkKTt2YXIgbD1hLmNyZWF0ZUVuY3J5cHRvcihiLGQpO2M9bC5maW5hbGl6ZShjKTtsPWwuY2ZnO3JldHVybiBlLmNyZWF0ZSh7Y2lwaGVydGV4dDpjLGtleTpiLGl2OmwuaXYsYWxnb3JpdGhtOmEsbW9kZTpsLm1vZGUscGFkZGluZzpsLnBhZGRpbmcsYmxvY2tTaXplOmEuYmxvY2tTaXplLGZvcm1hdHRlcjpkLmZvcm1hdH0pfSwKICAgIGRlY3J5cHQ6ZnVuY3Rpb24oYSxjLGIsZSl7ZT10aGlzLmNmZy5leHRlbmQoZSk7Yz10aGlzLl9wYXJzZShjLGUuZm9ybWF0KTtyZXR1cm4gYS5jcmVhdGVEZWNyeXB0b3IoYixlKS5maW5hbGl6ZShjLmNpcGhlcnRleHQpfSxfcGFyc2U6ZnVuY3Rpb24oYSxjKXtyZXR1cm4ic3RyaW5nIj09dHlwZW9mIGE/Yy5wYXJzZShhLHRoaXMpOmF9fSksbD0obC5rZGY9e30pLk9wZW5TU0w9e2V4ZWN1dGU6ZnVuY3Rpb24oYSxjLGIsZCl7ZHx8KGQ9cC5yYW5kb20oOCkpO2E9dy5jcmVhdGUoe2tleVNpemU6YytifSkuY29tcHV0ZShhLGQpO2I9cC5jcmVhdGUoYS53b3Jkcy5zbGljZShjKSw0KmIpO2Euc2lnQnl0ZXM9NCpjO3JldHVybiBlLmNyZWF0ZSh7a2V5OmEsaXY6YixzYWx0OmR9KX19LGM9ZC5QYXNzd29yZEJhc2VkQ2lwaGVyPWEuZXh0ZW5kKHtjZmc6YS5jZmcuZXh0ZW5kKHtrZGY6bH0pLGVuY3J5cHQ6ZnVuY3Rpb24oYyxiLGUsZCl7ZD10aGlzLmNmZy5leHRlbmQoZCk7ZT1kLmtkZi5leGVjdXRlKGUsCiAgICBjLmtleVNpemUsYy5pdlNpemUpO2QuaXY9ZS5pdjtjPWEuZW5jcnlwdC5jYWxsKHRoaXMsYyxiLGUua2V5LGQpO2MubWl4SW4oZSk7cmV0dXJuIGN9LGRlY3J5cHQ6ZnVuY3Rpb24oYyxiLGUsZCl7ZD10aGlzLmNmZy5leHRlbmQoZCk7Yj10aGlzLl9wYXJzZShiLGQuZm9ybWF0KTtlPWQua2RmLmV4ZWN1dGUoZSxjLmtleVNpemUsYy5pdlNpemUsYi5zYWx0KTtkLml2PWUuaXY7cmV0dXJuIGEuZGVjcnlwdC5jYWxsKHRoaXMsYyxiLGUua2V5LGQpfX0pfSgpOwooZnVuY3Rpb24oKXtmdW5jdGlvbiB1KGIsYSl7dmFyIGM9KHRoaXMuX2xCbG9jaz4+PmJedGhpcy5fckJsb2NrKSZhO3RoaXMuX3JCbG9ja149Yzt0aGlzLl9sQmxvY2tePWM8PGJ9ZnVuY3Rpb24gbChiLGEpe3ZhciBjPSh0aGlzLl9yQmxvY2s+Pj5iXnRoaXMuX2xCbG9jaykmYTt0aGlzLl9sQmxvY2tePWM7dGhpcy5fckJsb2NrXj1jPDxifXZhciBkPUNyeXB0b0pTLG49ZC5saWIscD1uLldvcmRBcnJheSxuPW4uQmxvY2tDaXBoZXIscz1kLmFsZ28scT1bNTcsNDksNDEsMzMsMjUsMTcsOSwxLDU4LDUwLDQyLDM0LDI2LDE4LDEwLDIsNTksNTEsNDMsMzUsMjcsMTksMTEsMyw2MCw1Miw0NCwzNiw2Myw1NSw0NywzOSwzMSwyMywxNSw3LDYyLDU0LDQ2LDM4LDMwLDIyLDE0LDYsNjEsNTMsNDUsMzcsMjksMjEsMTMsNSwyOCwyMCwxMiw0XSx3PVsxNCwxNywxMSwyNCwxLDUsMywyOCwxNSw2LDIxLDEwLDIzLDE5LDEyLDQsMjYsOCwxNiw3LDI3LDIwLDEzLDIsNDEsNTIsMzEsMzcsNDcsCiAgICA1NSwzMCw0MCw1MSw0NSwzMyw0OCw0NCw0OSwzOSw1NiwzNCw1Myw0Niw0Miw1MCwzNiwyOSwzMl0sdj1bMSwyLDQsNiw4LDEwLDEyLDE0LDE1LDE3LDE5LDIxLDIzLDI1LDI3LDI4XSxiPVt7IjAiOjg0MjE4ODgsMjY4NDM1NDU2OjMyNzY4LDUzNjg3MDkxMjo4NDIxMzc4LDgwNTMwNjM2ODoyLDEwNzM3NDE4MjQ6NTEyLDEzNDIxNzcyODA6ODQyMTg5MCwxNjEwNjEyNzM2OjgzODkxMjIsMTg3OTA0ODE5Mjo4Mzg4NjA4LDIxNDc0ODM2NDg6NTE0LDI0MTU5MTkxMDQ6ODM4OTEyMCwyNjg0MzU0NTYwOjMzMjgwLDI5NTI3OTAwMTY6ODQyMTM3NiwzMjIxMjI1NDcyOjMyNzcwLDM0ODk2NjA5Mjg6ODM4ODYxMCwzNzU4MDk2Mzg0OjAsNDAyNjUzMTg0MDozMzI4MiwxMzQyMTc3Mjg6MCw0MDI2NTMxODQ6ODQyMTg5MCw2NzEwODg2NDA6MzMyODIsOTM5NTI0MDk2OjMyNzY4LDEyMDc5NTk1NTI6ODQyMTg4OCwxNDc2Mzk1MDA4OjUxMiwxNzQ0ODMwNDY0Ojg0MjEzNzgsMjAxMzI2NTkyMDoyLAogICAgMjI4MTcwMTM3Njo4Mzg5MTIwLDI1NTAxMzY4MzI6MzMyODAsMjgxODU3MjI4ODo4NDIxMzc2LDMwODcwMDc3NDQ6ODM4OTEyMiwzMzU1NDQzMjAwOjgzODg2MTAsMzYyMzg3ODY1NjozMjc3MCwzODkyMzE0MTEyOjUxNCw0MTYwNzQ5NTY4OjgzODg2MDgsMTozMjc2OCwyNjg0MzU0NTc6Miw1MzY4NzA5MTM6ODQyMTg4OCw4MDUzMDYzNjk6ODM4ODYwOCwxMDczNzQxODI1Ojg0MjEzNzgsMTM0MjE3NzI4MTozMzI4MCwxNjEwNjEyNzM3OjUxMiwxODc5MDQ4MTkzOjgzODkxMjIsMjE0NzQ4MzY0OTo4NDIxODkwLDI0MTU5MTkxMDU6ODQyMTM3NiwyNjg0MzU0NTYxOjgzODg2MTAsMjk1Mjc5MDAxNzozMzI4MiwzMjIxMjI1NDczOjUxNCwzNDg5NjYwOTI5OjgzODkxMjAsMzc1ODA5NjM4NTozMjc3MCw0MDI2NTMxODQxOjAsMTM0MjE3NzI5Ojg0MjE4OTAsNDAyNjUzMTg1Ojg0MjEzNzYsNjcxMDg4NjQxOjgzODg2MDgsOTM5NTI0MDk3OjUxMiwxMjA3OTU5NTUzOjMyNzY4LDE0NzYzOTUwMDk6ODM4ODYxMCwKICAgIDE3NDQ4MzA0NjU6MiwyMDEzMjY1OTIxOjMzMjgyLDIyODE3MDEzNzc6MzI3NzAsMjU1MDEzNjgzMzo4Mzg5MTIyLDI4MTg1NzIyODk6NTE0LDMwODcwMDc3NDU6ODQyMTg4OCwzMzU1NDQzMjAxOjgzODkxMjAsMzYyMzg3ODY1NzowLDM4OTIzMTQxMTM6MzMyODAsNDE2MDc0OTU2OTo4NDIxMzc4fSx7IjAiOjEwNzQyODI1MTIsMTY3NzcyMTY6MTYzODQsMzM1NTQ0MzI6NTI0Mjg4LDUwMzMxNjQ4OjEwNzQyNjYxMjgsNjcxMDg4NjQ6MTA3Mzc0MTg0MCw4Mzg4NjA4MDoxMDc0MjgyNDk2LDEwMDY2MzI5NjoxMDczNzU4MjA4LDExNzQ0MDUxMjoxNiwxMzQyMTc3Mjg6NTQwNjcyLDE1MDk5NDk0NDoxMDczNzU4MjI0LDE2Nzc3MjE2MDoxMDczNzQxODI0LDE4NDU0OTM3Njo1NDA2ODgsMjAxMzI2NTkyOjUyNDMwNCwyMTgxMDM4MDg6MCwyMzQ4ODEwMjQ6MTY0MDAsMjUxNjU4MjQwOjEwNzQyNjYxMTIsODM4ODYwODoxMDczNzU4MjA4LDI1MTY1ODI0OjU0MDY4OCw0MTk0MzA0MDoxNiw1ODcyMDI1NjoxMDczNzU4MjI0LAogICAgNzU0OTc0NzI6MTA3NDI4MjUxMiw5MjI3NDY4ODoxMDczNzQxODI0LDEwOTA1MTkwNDo1MjQyODgsMTI1ODI5MTIwOjEwNzQyNjYxMjgsMTQyNjA2MzM2OjUyNDMwNCwxNTkzODM1NTI6MCwxNzYxNjA3Njg6MTYzODQsMTkyOTM3OTg0OjEwNzQyNjYxMTIsMjA5NzE1MjAwOjEwNzM3NDE4NDAsMjI2NDkyNDE2OjU0MDY3MiwyNDMyNjk2MzI6MTA3NDI4MjQ5NiwyNjAwNDY4NDg6MTY0MDAsMjY4NDM1NDU2OjAsMjg1MjEyNjcyOjEwNzQyNjYxMjgsMzAxOTg5ODg4OjEwNzM3NTgyMjQsMzE4NzY3MTA0OjEwNzQyODI0OTYsMzM1NTQ0MzIwOjEwNzQyNjYxMTIsMzUyMzIxNTM2OjE2LDM2OTA5ODc1Mjo1NDA2ODgsMzg1ODc1OTY4OjE2Mzg0LDQwMjY1MzE4NDoxNjQwMCw0MTk0MzA0MDA6NTI0Mjg4LDQzNjIwNzYxNjo1MjQzMDQsNDUyOTg0ODMyOjEwNzM3NDE4NDAsNDY5NzYyMDQ4OjU0MDY3Miw0ODY1MzkyNjQ6MTA3Mzc1ODIwOCw1MDMzMTY0ODA6MTA3Mzc0MTgyNCw1MjAwOTM2OTY6MTA3NDI4MjUxMiwKICAgIDI3NjgyNDA2NDo1NDA2ODgsMjkzNjAxMjgwOjUyNDI4OCwzMTAzNzg0OTY6MTA3NDI2NjExMiwzMjcxNTU3MTI6MTYzODQsMzQzOTMyOTI4OjEwNzM3NTgyMDgsMzYwNzEwMTQ0OjEwNzQyODI1MTIsMzc3NDg3MzYwOjE2LDM5NDI2NDU3NjoxMDczNzQxODI0LDQxMTA0MTc5MjoxMDc0MjgyNDk2LDQyNzgxOTAwODoxMDczNzQxODQwLDQ0NDU5NjIyNDoxMDczNzU4MjI0LDQ2MTM3MzQ0MDo1MjQzMDQsNDc4MTUwNjU2OjAsNDk0OTI3ODcyOjE2NDAwLDUxMTcwNTA4ODoxMDc0MjY2MTI4LDUyODQ4MjMwNDo1NDA2NzJ9LHsiMCI6MjYwLDEwNDg1NzY6MCwyMDk3MTUyOjY3MTA5MTIwLDMxNDU3Mjg6NjU3OTYsNDE5NDMwNDo2NTU0MCw1MjQyODgwOjY3MTA4ODY4LDYyOTE0NTY6NjcxNzQ2NjAsNzM0MDAzMjo2NzE3NDQwMCw4Mzg4NjA4OjY3MTA4ODY0LDk0MzcxODQ6NjcxNzQ2NTYsMTA0ODU3NjA6NjU3OTIsMTE1MzQzMzY6NjcxNzQ0MDQsMTI1ODI5MTI6NjcxMDkxMjQsMTM2MzE0ODg6NjU1MzYsCiAgICAxNDY4MDA2NDo0LDE1NzI4NjQwOjI1Niw1MjQyODg6NjcxNzQ2NTYsMTU3Mjg2NDo2NzE3NDQwNCwyNjIxNDQwOjAsMzY3MDAxNjo2NzEwOTEyMCw0NzE4NTkyOjY3MTA4ODY4LDU3NjcxNjg6NjU1MzYsNjgxNTc0NDo2NTU0MCw3ODY0MzIwOjI2MCw4OTEyODk2OjQsOTk2MTQ3MjoyNTYsMTEwMTAwNDg6NjcxNzQ0MDAsMTIwNTg2MjQ6NjU3OTYsMTMxMDcyMDA6NjU3OTIsMTQxNTU3NzY6NjcxMDkxMjQsMTUyMDQzNTI6NjcxNzQ2NjAsMTYyNTI5Mjg6NjcxMDg4NjQsMTY3NzcyMTY6NjcxNzQ2NTYsMTc4MjU3OTI6NjU1NDAsMTg4NzQzNjg6NjU1MzYsMTk5MjI5NDQ6NjcxMDkxMjAsMjA5NzE1MjA6MjU2LDIyMDIwMDk2OjY3MTc0NjYwLDIzMDY4NjcyOjY3MTA4ODY4LDI0MTE3MjQ4OjAsMjUxNjU4MjQ6NjcxMDkxMjQsMjYyMTQ0MDA6NjcxMDg4NjQsMjcyNjI5NzY6NCwyODMxMTU1Mjo2NTc5MiwyOTM2MDEyODo2NzE3NDQwMCwzMDQwODcwNDoyNjAsMzE0NTcyODA6NjU3OTYsMzI1MDU4NTY6NjcxNzQ0MDQsCiAgICAxNzMwMTUwNDo2NzEwODg2NCwxODM1MDA4MDoyNjAsMTkzOTg2NTY6NjcxNzQ2NTYsMjA0NDcyMzI6MCwyMTQ5NTgwODo2NTU0MCwyMjU0NDM4NDo2NzEwOTEyMCwyMzU5Mjk2MDoyNTYsMjQ2NDE1MzY6NjcxNzQ0MDQsMjU2OTAxMTI6NjU1MzYsMjY3Mzg2ODg6NjcxNzQ2NjAsMjc3ODcyNjQ6NjU3OTYsMjg4MzU4NDA6NjcxMDg4NjgsMjk4ODQ0MTY6NjcxMDkxMjQsMzA5MzI5OTI6NjcxNzQ0MDAsMzE5ODE1Njg6NCwzMzAzMDE0NDo2NTc5Mn0seyIwIjoyMTUxNjgyMDQ4LDY1NTM2OjIxNDc0ODc4MDgsMTMxMDcyOjQxOTg0NjQsMTk2NjA4OjIxNTE2Nzc5NTIsMjYyMTQ0OjAsMzI3NjgwOjQxOTg0MDAsMzkzMjE2OjIxNDc0ODM3MTIsNDU4NzUyOjQxOTQzNjgsNTI0Mjg4OjIxNDc0ODM2NDgsNTg5ODI0OjQxOTQzMDQsNjU1MzYwOjY0LDcyMDg5NjoyMTQ3NDg3NzQ0LDc4NjQzMjoyMTUxNjc4MDE2LDg1MTk2ODo0MTYwLDkxNzUwNDo0MDk2LDk4MzA0MDoyMTUxNjgyMTEyLDMyNzY4OjIxNDc0ODc4MDgsCiAgICA5ODMwNDo2NCwxNjM4NDA6MjE1MTY3ODAxNiwyMjkzNzY6MjE0NzQ4Nzc0NCwyOTQ5MTI6NDE5ODQwMCwzNjA0NDg6MjE1MTY4MjExMiw0MjU5ODQ6MCw0OTE1MjA6MjE1MTY3Nzk1Miw1NTcwNTY6NDA5Niw2MjI1OTI6MjE1MTY4MjA0OCw2ODgxMjg6NDE5NDMwNCw3NTM2NjQ6NDE2MCw4MTkyMDA6MjE0NzQ4MzY0OCw4ODQ3MzY6NDE5NDM2OCw5NTAyNzI6NDE5ODQ2NCwxMDE1ODA4OjIxNDc0ODM3MTIsMTA0ODU3Njo0MTk0MzY4LDExMTQxMTI6NDE5ODQwMCwxMTc5NjQ4OjIxNDc0ODM3MTIsMTI0NTE4NDowLDEzMTA3MjA6NDE2MCwxMzc2MjU2OjIxNTE2NzgwMTYsMTQ0MTc5MjoyMTUxNjgyMDQ4LDE1MDczMjg6MjE0NzQ4NzgwOCwxNTcyODY0OjIxNTE2ODIxMTIsMTYzODQwMDoyMTQ3NDgzNjQ4LDE3MDM5MzY6MjE1MTY3Nzk1MiwxNzY5NDcyOjQxOTg0NjQsMTgzNTAwODoyMTQ3NDg3NzQ0LDE5MDA1NDQ6NDE5NDMwNCwxOTY2MDgwOjY0LDIwMzE2MTY6NDA5NiwxMDgxMzQ0OjIxNTE2Nzc5NTIsCiAgICAxMTQ2ODgwOjIxNTE2ODIxMTIsMTIxMjQxNjowLDEyNzc5NTI6NDE5ODQwMCwxMzQzNDg4OjQxOTQzNjgsMTQwOTAyNDoyMTQ3NDgzNjQ4LDE0NzQ1NjA6MjE0NzQ4NzgwOCwxNTQwMDk2OjY0LDE2MDU2MzI6MjE0NzQ4MzcxMiwxNjcxMTY4OjQwOTYsMTczNjcwNDoyMTQ3NDg3NzQ0LDE4MDIyNDA6MjE1MTY3ODAxNiwxODY3Nzc2OjQxNjAsMTkzMzMxMjoyMTUxNjgyMDQ4LDE5OTg4NDg6NDE5NDMwNCwyMDY0Mzg0OjQxOTg0NjR9LHsiMCI6MTI4LDQwOTY6MTcwMzkzNjAsODE5MjoyNjIxNDQsMTIyODg6NTM2ODcwOTEyLDE2Mzg0OjUzNzEzMzE4NCwyMDQ4MDoxNjc3NzM0NCwyNDU3Njo1NTM2NDgyNTYsMjg2NzI6MjYyMjcyLDMyNzY4OjE2Nzc3MjE2LDM2ODY0OjUzNzEzMzA1Niw0MDk2MDo1MzY4NzEwNDAsNDUwNTY6NTUzOTEwNDAwLDQ5MTUyOjU1MzkxMDI3Miw1MzI0ODowLDU3MzQ0OjE3MDM5NDg4LDYxNDQwOjU1MzY0ODEyOCwyMDQ4OjE3MDM5NDg4LDYxNDQ6NTUzNjQ4MjU2LAogICAgMTAyNDA6MTI4LDE0MzM2OjE3MDM5MzYwLDE4NDMyOjI2MjE0NCwyMjUyODo1MzcxMzMxODQsMjY2MjQ6NTUzOTEwMjcyLDMwNzIwOjUzNjg3MDkxMiwzNDgxNjo1MzcxMzMwNTYsMzg5MTI6MCw0MzAwODo1NTM5MTA0MDAsNDcxMDQ6MTY3NzczNDQsNTEyMDA6NTM2ODcxMDQwLDU1Mjk2OjU1MzY0ODEyOCw1OTM5MjoxNjc3NzIxNiw2MzQ4ODoyNjIyNzIsNjU1MzY6MjYyMTQ0LDY5NjMyOjEyOCw3MzcyODo1MzY4NzA5MTIsNzc4MjQ6NTUzNjQ4MjU2LDgxOTIwOjE2Nzc3MzQ0LDg2MDE2OjU1MzkxMDI3Miw5MDExMjo1MzcxMzMxODQsOTQyMDg6MTY3NzcyMTYsOTgzMDQ6NTUzOTEwNDAwLDEwMjQwMDo1NTM2NDgxMjgsMTA2NDk2OjE3MDM5MzYwLDExMDU5Mjo1MzcxMzMwNTYsMTE0Njg4OjI2MjI3MiwxMTg3ODQ6NTM2ODcxMDQwLDEyMjg4MDowLDEyNjk3NjoxNzAzOTQ4OCw2NzU4NDo1NTM2NDgyNTYsNzE2ODA6MTY3NzcyMTYsNzU3NzY6MTcwMzkzNjAsNzk4NzI6NTM3MTMzMTg0LAogICAgODM5Njg6NTM2ODcwOTEyLDg4MDY0OjE3MDM5NDg4LDkyMTYwOjEyOCw5NjI1Njo1NTM5MTAyNzIsMTAwMzUyOjI2MjI3MiwxMDQ0NDg6NTUzOTEwNDAwLDEwODU0NDowLDExMjY0MDo1NTM2NDgxMjgsMTE2NzM2OjE2Nzc3MzQ0LDEyMDgzMjoyNjIxNDQsMTI0OTI4OjUzNzEzMzA1NiwxMjkwMjQ6NTM2ODcxMDQwfSx7IjAiOjI2ODQzNTQ2NCwyNTY6ODE5Miw1MTI6MjcwNTMyNjA4LDc2ODoyNzA1NDA4MDgsMTAyNDoyNjg0NDM2NDgsMTI4MDoyMDk3MTUyLDE1MzY6MjA5NzE2MCwxNzkyOjI2ODQzNTQ1NiwyMDQ4OjAsMjMwNDoyNjg0NDM2NTYsMjU2MDoyMTA1MzQ0LDI4MTY6OCwzMDcyOjI3MDUzMjYxNiwzMzI4OjIxMDUzNTIsMzU4NDo4MjAwLDM4NDA6MjcwNTQwODAwLDEyODoyNzA1MzI2MDgsMzg0OjI3MDU0MDgwOCw2NDA6OCw4OTY6MjA5NzE1MiwxMTUyOjIxMDUzNTIsMTQwODoyNjg0MzU0NjQsMTY2NDoyNjg0NDM2NDgsMTkyMDo4MjAwLDIxNzY6MjA5NzE2MCwyNDMyOjgxOTIsCiAgICAyNjg4OjI2ODQ0MzY1NiwyOTQ0OjI3MDUzMjYxNiwzMjAwOjAsMzQ1NjoyNzA1NDA4MDAsMzcxMjoyMTA1MzQ0LDM5Njg6MjY4NDM1NDU2LDQwOTY6MjY4NDQzNjQ4LDQzNTI6MjcwNTMyNjE2LDQ2MDg6MjcwNTQwODA4LDQ4NjQ6ODIwMCw1MTIwOjIwOTcxNTIsNTM3NjoyNjg0MzU0NTYsNTYzMjoyNjg0MzU0NjQsNTg4ODoyMTA1MzQ0LDYxNDQ6MjEwNTM1Miw2NDAwOjAsNjY1Njo4LDY5MTI6MjcwNTMyNjA4LDcxNjg6ODE5Miw3NDI0OjI2ODQ0MzY1Niw3NjgwOjI3MDU0MDgwMCw3OTM2OjIwOTcxNjAsNDIyNDo4LDQ0ODA6MjEwNTM0NCw0NzM2OjIwOTcxNTIsNDk5MjoyNjg0MzU0NjQsNTI0ODoyNjg0NDM2NDgsNTUwNDo4MjAwLDU3NjA6MjcwNTQwODA4LDYwMTY6MjcwNTMyNjA4LDYyNzI6MjcwNTQwODAwLDY1Mjg6MjcwNTMyNjE2LDY3ODQ6ODE5Miw3MDQwOjIxMDUzNTIsNzI5NjoyMDk3MTYwLDc1NTI6MCw3ODA4OjI2ODQzNTQ1Niw4MDY0OjI2ODQ0MzY1Nn0seyIwIjoxMDQ4NTc2LAogICAgMTY6MzM1NTU0NTcsMzI6MTAyNCw0ODoxMDQ5NjAxLDY0OjM0NjA0MDMzLDgwOjAsOTY6MSwxMTI6MzQ2MDMwMDksMTI4OjMzNTU1NDU2LDE0NDoxMDQ4NTc3LDE2MDozMzU1NDQzMywxNzY6MzQ2MDQwMzIsMTkyOjM0NjAzMDA4LDIwODoxMDI1LDIyNDoxMDQ5NjAwLDI0MDozMzU1NDQzMiw4OjM0NjAzMDA5LDI0OjAsNDA6MzM1NTU0NTcsNTY6MzQ2MDQwMzIsNzI6MTA0ODU3Niw4ODozMzU1NDQzMywxMDQ6MzM1NTQ0MzIsMTIwOjEwMjUsMTM2OjEwNDk2MDEsMTUyOjMzNTU1NDU2LDE2ODozNDYwMzAwOCwxODQ6MTA0ODU3NywyMDA6MTAyNCwyMTY6MzQ2MDQwMzMsMjMyOjEsMjQ4OjEwNDk2MDAsMjU2OjMzNTU0NDMyLDI3MjoxMDQ4NTc2LDI4ODozMzU1NTQ1NywzMDQ6MzQ2MDMwMDksMzIwOjEwNDg1NzcsMzM2OjMzNTU1NDU2LDM1MjozNDYwNDAzMiwzNjg6MTA0OTYwMSwzODQ6MTAyNSw0MDA6MzQ2MDQwMzMsNDE2OjEwNDk2MDAsNDMyOjEsNDQ4OjAsNDY0OjM0NjAzMDA4LDQ4MDozMzU1NDQzMywKICAgIDQ5NjoxMDI0LDI2NDoxMDQ5NjAwLDI4MDozMzU1NTQ1NywyOTY6MzQ2MDMwMDksMzEyOjEsMzI4OjMzNTU0NDMyLDM0NDoxMDQ4NTc2LDM2MDoxMDI1LDM3NjozNDYwNDAzMiwzOTI6MzM1NTQ0MzMsNDA4OjM0NjAzMDA4LDQyNDowLDQ0MDozNDYwNDAzMyw0NTY6MTA0OTYwMSw0NzI6MTAyNCw0ODg6MzM1NTU0NTYsNTA0OjEwNDg1Nzd9LHsiMCI6MTM0MjE5ODA4LDE6MTMxMDcyLDI6MTM0MjE3NzI4LDM6MzIsNDoxMzExMDQsNToxMzQzNTA4ODAsNjoxMzQzNTA4NDgsNzoyMDQ4LDg6MTM0MzQ4ODAwLDk6MTM0MjE5Nzc2LDEwOjEzMzEyMCwxMToxMzQzNDg4MzIsMTI6MjA4MCwxMzowLDE0OjEzNDIxNzc2MCwxNToxMzMxNTIsMjE0NzQ4MzY0ODoyMDQ4LDIxNDc0ODM2NDk6MTM0MzUwODgwLDIxNDc0ODM2NTA6MTM0MjE5ODA4LDIxNDc0ODM2NTE6MTM0MjE3NzI4LDIxNDc0ODM2NTI6MTM0MzQ4ODAwLDIxNDc0ODM2NTM6MTMzMTIwLDIxNDc0ODM2NTQ6MTMzMTUyLDIxNDc0ODM2NTU6MzIsCiAgICAyMTQ3NDgzNjU2OjEzNDIxNzc2MCwyMTQ3NDgzNjU3OjIwODAsMjE0NzQ4MzY1ODoxMzExMDQsMjE0NzQ4MzY1OToxMzQzNTA4NDgsMjE0NzQ4MzY2MDowLDIxNDc0ODM2NjE6MTM0MzQ4ODMyLDIxNDc0ODM2NjI6MTM0MjE5Nzc2LDIxNDc0ODM2NjM6MTMxMDcyLDE2OjEzMzE1MiwxNzoxMzQzNTA4NDgsMTg6MzIsMTk6MjA0OCwyMDoxMzQyMTk3NzYsMjE6MTM0MjE3NzYwLDIyOjEzNDM0ODgzMiwyMzoxMzEwNzIsMjQ6MCwyNToxMzExMDQsMjY6MTM0MzQ4ODAwLDI3OjEzNDIxOTgwOCwyODoxMzQzNTA4ODAsMjk6MTMzMTIwLDMwOjIwODAsMzE6MTM0MjE3NzI4LDIxNDc0ODM2NjQ6MTMxMDcyLDIxNDc0ODM2NjU6MjA0OCwyMTQ3NDgzNjY2OjEzNDM0ODgzMiwyMTQ3NDgzNjY3OjEzMzE1MiwyMTQ3NDgzNjY4OjMyLDIxNDc0ODM2Njk6MTM0MzQ4ODAwLDIxNDc0ODM2NzA6MTM0MjE3NzI4LDIxNDc0ODM2NzE6MTM0MjE5ODA4LDIxNDc0ODM2NzI6MTM0MzUwODgwLDIxNDc0ODM2NzM6MTM0MjE3NzYwLAogICAgMjE0NzQ4MzY3NDoxMzQyMTk3NzYsMjE0NzQ4MzY3NTowLDIxNDc0ODM2NzY6MTMzMTIwLDIxNDc0ODM2Nzc6MjA4MCwyMTQ3NDgzNjc4OjEzMTEwNCwyMTQ3NDgzNjc5OjEzNDM1MDg0OH1dLHg9WzQxNjA3NDk1NjksNTI4NDgyMzA0LDMzMDMwMTQ0LDIwNjQzODQsMTI5MDI0LDgwNjQsNTA0LDIxNDc0ODM2NzldLHI9cy5ERVM9bi5leHRlbmQoe19kb1Jlc2V0OmZ1bmN0aW9uKCl7Zm9yKHZhciBiPXRoaXMuX2tleS53b3JkcyxhPVtdLGM9MDs1Nj5jO2MrKyl7dmFyIGQ9cVtjXS0xO2FbY109YltkPj4+NV0+Pj4zMS1kJTMyJjF9Yj10aGlzLl9zdWJLZXlzPVtdO2ZvcihkPTA7MTY+ZDtkKyspe2Zvcih2YXIgZj1iW2RdPVtdLGw9dltkXSxjPTA7MjQ+YztjKyspZltjLzZ8MF18PWFbKHdbY10tMStsKSUyOF08PDMxLWMlNixmWzQrKGMvNnwwKV18PWFbMjgrKHdbYysyNF0tMStsKSUyOF08PDMxLWMlNjtmWzBdPWZbMF08PDF8ZlswXT4+PjMxO2ZvcihjPTE7Nz5jO2MrKylmW2NdPj4+PQogICAgNCooYy0xKSszO2ZbN109Zls3XTw8NXxmWzddPj4+Mjd9YT10aGlzLl9pbnZTdWJLZXlzPVtdO2ZvcihjPTA7MTY+YztjKyspYVtjXT1iWzE1LWNdfSxlbmNyeXB0QmxvY2s6ZnVuY3Rpb24oYixhKXt0aGlzLl9kb0NyeXB0QmxvY2soYixhLHRoaXMuX3N1YktleXMpfSxkZWNyeXB0QmxvY2s6ZnVuY3Rpb24oYixhKXt0aGlzLl9kb0NyeXB0QmxvY2soYixhLHRoaXMuX2ludlN1YktleXMpfSxfZG9DcnlwdEJsb2NrOmZ1bmN0aW9uKGUsYSxjKXt0aGlzLl9sQmxvY2s9ZVthXTt0aGlzLl9yQmxvY2s9ZVthKzFdO3UuY2FsbCh0aGlzLDQsMjUyNjQ1MTM1KTt1LmNhbGwodGhpcywxNiw2NTUzNSk7bC5jYWxsKHRoaXMsMiw4NTg5OTM0NTkpO2wuY2FsbCh0aGlzLDgsMTY3MTE5MzUpO3UuY2FsbCh0aGlzLDEsMTQzMTY1NTc2NSk7Zm9yKHZhciBkPTA7MTY+ZDtkKyspe2Zvcih2YXIgZj1jW2RdLG49dGhpcy5fbEJsb2NrLHA9dGhpcy5fckJsb2NrLHE9MCxyPTA7OD5yO3IrKylxfD1iW3JdWygocF4KZltyXSkmeFtyXSk+Pj4wXTt0aGlzLl9sQmxvY2s9cDt0aGlzLl9yQmxvY2s9bl5xfWM9dGhpcy5fbEJsb2NrO3RoaXMuX2xCbG9jaz10aGlzLl9yQmxvY2s7dGhpcy5fckJsb2NrPWM7dS5jYWxsKHRoaXMsMSwxNDMxNjU1NzY1KTtsLmNhbGwodGhpcyw4LDE2NzExOTM1KTtsLmNhbGwodGhpcywyLDg1ODk5MzQ1OSk7dS5jYWxsKHRoaXMsMTYsNjU1MzUpO3UuY2FsbCh0aGlzLDQsMjUyNjQ1MTM1KTtlW2FdPXRoaXMuX2xCbG9jaztlW2ErMV09dGhpcy5fckJsb2NrfSxrZXlTaXplOjIsaXZTaXplOjIsYmxvY2tTaXplOjJ9KTtkLkRFUz1uLl9jcmVhdGVIZWxwZXIocik7cz1zLlRyaXBsZURFUz1uLmV4dGVuZCh7X2RvUmVzZXQ6ZnVuY3Rpb24oKXt2YXIgYj10aGlzLl9rZXkud29yZHM7dGhpcy5fZGVzMT1yLmNyZWF0ZUVuY3J5cHRvcihwLmNyZWF0ZShiLnNsaWNlKDAsMikpKTt0aGlzLl9kZXMyPXIuY3JlYXRlRW5jcnlwdG9yKHAuY3JlYXRlKGIuc2xpY2UoMiw0KSkpO3RoaXMuX2RlczM9CiAgICByLmNyZWF0ZUVuY3J5cHRvcihwLmNyZWF0ZShiLnNsaWNlKDQsNikpKX0sZW5jcnlwdEJsb2NrOmZ1bmN0aW9uKGIsYSl7dGhpcy5fZGVzMS5lbmNyeXB0QmxvY2soYixhKTt0aGlzLl9kZXMyLmRlY3J5cHRCbG9jayhiLGEpO3RoaXMuX2RlczMuZW5jcnlwdEJsb2NrKGIsYSl9LGRlY3J5cHRCbG9jazpmdW5jdGlvbihiLGEpe3RoaXMuX2RlczMuZGVjcnlwdEJsb2NrKGIsYSk7dGhpcy5fZGVzMi5lbmNyeXB0QmxvY2soYixhKTt0aGlzLl9kZXMxLmRlY3J5cHRCbG9jayhiLGEpfSxrZXlTaXplOjYsaXZTaXplOjIsYmxvY2tTaXplOjJ9KTtkLlRyaXBsZURFUz1uLl9jcmVhdGVIZWxwZXIocyl9KSgpOwoKCkNyeXB0b0pTLm1vZGUuRUNCID0gKGZ1bmN0aW9uICgpIHsKICAgIHZhciBFQ0IgPSBDcnlwdG9KUy5saWIuQmxvY2tDaXBoZXJNb2RlLmV4dGVuZCgpOwoKICAgIEVDQi5FbmNyeXB0b3IgPSBFQ0IuZXh0ZW5kKHsKICAgICAgICBwcm9jZXNzQmxvY2s6IGZ1bmN0aW9uICh3b3Jkcywgb2Zmc2V0KSB7CiAgICAgICAgICAgIHRoaXMuX2NpcGhlci5lbmNyeXB0QmxvY2sod29yZHMsIG9mZnNldCk7CiAgICAgICAgfQogICAgfSk7CgogICAgRUNCLkRlY3J5cHRvciA9IEVDQi5leHRlbmQoewogICAgICAgIHByb2Nlc3NCbG9jazogZnVuY3Rpb24gKHdvcmRzLCBvZmZzZXQpIHsKICAgICAgICAgICAgdGhpcy5fY2lwaGVyLmRlY3J5cHRCbG9jayh3b3Jkcywgb2Zmc2V0KTsKICAgICAgICB9CiAgICB9KTsKCiAgICByZXR1cm4gRUNCOwp9KCkpOw==";

    @Override
    public HttpResult<Map<String, Object>> init(OperatorParam param) {
        HttpResult<Map<String, Object>> result = new HttpResult<>();
        try {
            //获取imgReqSeq
            Response response = TaskHttpClient.create(param, RequestType.GET, "jiang_su_10086_wap_001").setFullUrl("http://wap.js.10086.cn/login.thtml").invoke();
            String pageContent = response.getPageContent();
            String imgReqSeq = RegexpUtils.select(pageContent, "id=\\\\\"imgReqSeq\\\\\" value=\\\\\"(.+?)\\\\\"", 1);
            TaskUtils.addTaskShare(param.getTaskId(), "imgReqSeq", imgReqSeq);
            return result.success();
        } catch (Exception e) {
            logger.error("登录-->初始化失败,param={}", param, e);
            return result.failure(ErrorCode.TASK_INIT_ERROR);
        }
    }

    @Override
    public HttpResult<String> refeshPicCode(OperatorParam param) {
        switch (param.getFormType()) {
            case FormType.LOGIN:
                return refeshPicCodeForLogin(param);
            default:
                return new HttpResult<String>().failure(ErrorCode.NOT_SUPORT_METHOD);
        }
    }

    @Override
    public HttpResult<Map<String, Object>> refeshSmsCode(OperatorParam param) {
        switch (param.getFormType()) {
            case FormType.VALIDATE_BILL_DETAIL:
                return refeshSmsCodeForBillDetail(param);
            default:
                return new HttpResult<Map<String, Object>>().failure(ErrorCode.NOT_SUPORT_METHOD);
        }
    }

    @Override
    public HttpResult<Map<String, Object>> submit(OperatorParam param) {
        switch (param.getFormType()) {
            case FormType.LOGIN:
                return submitForLogin(param);
            case FormType.VALIDATE_BILL_DETAIL:
                return submitForBillDetail(param);
            default:
                return new HttpResult<Map<String, Object>>().failure(ErrorCode.NOT_SUPORT_METHOD);
        }
    }

    @Override
    public HttpResult<Map<String, Object>> validatePicCode(OperatorParam param) {
        return new HttpResult<Map<String, Object>>().failure(ErrorCode.NOT_SUPORT_METHOD);
    }

    @Override
    public HttpResult<Object> defineProcess(OperatorParam param) {
        return new HttpResult<Object>().failure(ErrorCode.NOT_SUPORT_METHOD);
    }

    private HttpResult<String> refeshPicCodeForLogin(OperatorParam param) {
        HttpResult<String> result = new HttpResult<>();
        Response response = null;
        try {
            String imgReqSeq = TaskUtils.getTaskShare(param.getTaskId(), "imgReqSeq");
            String templateUrl = "http://wap.js.10086.cn/imageVerifyCode.do?t=0.{}&imgReqSeq={}";
            response = TaskHttpClient.create(param.getTaskId(), param.getWebsiteName(), RequestType.GET, "jiang_su_10086_wap_002")
                    .setFullUrl(templateUrl, System.currentTimeMillis(), imgReqSeq).invoke();
            logger.info("登录-->图片验证码-->刷新成功,param={}", param);
            return result.success(response.getPageContentForBase64());
        } catch (Exception e) {
            logger.error("登录-->图片验证码-->刷新失败,param={},response={}", param, response, e);
            return result.failure(ErrorCode.REFESH_PIC_CODE_ERROR);
        }
    }

    private HttpResult<Map<String, Object>> refeshSmsCodeForBillDetail(OperatorParam param) {
        HttpResult<Map<String, Object>> result = new HttpResult<>();
        Response response = null;
        String pageContent = null;
        try {
            // TODO: 2017/8/28 验证码在5分钟内有效，3次输入错误后失效。
            String templateUrl = "http://wap.js.10086.cn/actionDispatcher.do?reqUrl=smsVerifyCode&busiNum=QDCX";
            response = TaskHttpClient.create(param, RequestType.POST, "jiang_su_10086_wap_004").setFullUrl(templateUrl).invoke();
            pageContent = response.getPageContent();
            JSONObject json = response.getPageContentForJSON();
            if (json.getBoolean("success")) {
                logger.info("详单-->短信验证码-->刷新成功,param={}", param);
                return result.success();
            }
            String logicCode = json.getString("logicCode");
            switch (logicCode) {
                default:
                    logger.error("详单-->短信验证码-->刷新失败,param={},pageContent={}", param, pageContent);
                    return result.failure(ErrorCode.REFESH_SMS_UNEXPECTED_RESULT);
            }
        } catch (Exception e) {
            logger.error("详单-->短信验证码-->刷新失败,param={},response={}", param, response, e);
            return result.failure(ErrorCode.REFESH_SMS_ERROR);
        }
    }

    private HttpResult<Map<String, Object>> submitForBillDetail(OperatorParam param) {
        HttpResult<Map<String, Object>> result = new HttpResult<>();
        Response response = null;

        try {
            String queryMonth = DateUtils.format(new Date(), "yyyyMM");
            String templateUrl = "http://wap.js.10086.cn/actionDispatcher" +
                    ".do?reqUrl=billDetailTQry&busiNum=QDCX&currentPage=1&queryMonth={}&password_str=&ver=t&queryItem=1&browserFinger" +
                    "=&confirm_smsPassword={}&confirmFlg=1";
            response = TaskHttpClient.create(param, RequestType.POST, "jiang_su_10086_wap_005").setFullUrl(templateUrl, queryMonth, param
                    .getSmsCode()).invoke();
            String pageContent = response.getPageContent();
            JSONObject json = response.getPageContentForJSON();
            if (json.getBoolean("success")) {
                logger.info("详单-->校验成功,param={}", param);
                return result.success();
            } else {
                logger.error("详单-->校验失败,param={},pateContent={}", param, pageContent);
                return result.failure(ErrorCode.REFESH_SMS_UNEXPECTED_RESULT);
            }
        } catch (Exception e) {
            logger.error("详单-->校验失败,param={},response={}", param, response, e);
            return result.failure(ErrorCode.VALIDATE_ERROR);
        }
    }

    private HttpResult<Map<String, Object>> submitForLogin(OperatorParam param) {
        CheckUtils.checkNotBlank(param.getPassword(), ErrorCode.EMPTY_PASSWORD);
        CheckUtils.checkNotBlank(param.getPicCode(), ErrorCode.EMPTY_PIC_CODE);
        HttpResult<Map<String, Object>> result = new HttpResult<>();
        Response response = null;
        try {
            //InputStream inputStream = this.getClass().getClassLoader().getResourceAsStream("jiang_su_10086_wap/des.js");
            Invocable invocable = ScriptEngineUtil.createInvocableFromBase64(javaScript);
            String encryptPassword = invocable.invokeFunction("encryptByDES", param.getPassword()).toString();

            String imgReqSeq = TaskUtils.getTaskShare(param.getTaskId(), "imgReqSeq");
            String templateUrl = "http://wap.js.10086.cn/actionDispatcher" +
                    ".do?reqUrl=loginTouch&busiNum=login&mobile={}&password={}&isSavePasswordVal=1&verifyCode={}&isSms=0&ver=t&imgReqSeq" +
                    "={}&loginType=0&browserFinger=67be1e5ef791cecddc38fd6990b6ce1f";
            response = TaskHttpClient.create(param, RequestType.POST, "jiang_su_10086_wap_003")
                    .setFullUrl(templateUrl, param.getMobile(), encryptPassword, param.getPicCode(), imgReqSeq).invoke();
            JSONObject json = response.getPageContentForJSON();
            if (json.getBoolean("success")) {
                logger.warn("登录成功,params={}", param);
                return result.success();
            }
            String logicCode = json.getString("logicCode");
            switch (logicCode) {
                case "-4003":
                    logger.warn("登录失败-->图片验证码校验失败!param={}", param);
                    return result.failure(ErrorCode.VALIDATE_PIC_CODE_FAIL);
                default:
                    logger.warn("登录失败,param={},response={}", param, response);
                    return result.failure(ErrorCode.LOGIN_UNEXPECTED_RESULT);
            }
        } catch (Exception e) {
            logger.error("登陆失败,param={},response={}", param, response, e);
            return result.failure(ErrorCode.LOGIN_ERROR);
        }
    }

}
